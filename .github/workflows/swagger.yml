name: Swagger Documentation

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Generate Swagger Documentation
        run: |
          docker run --rm \
            -v "${PWD}:/local" \
            swaggerapi/swagger-codegen-cli generate \
            -i /local/docs/openapi.yml \
            -l html2 \
            -o /local/swagger-html

      - name: Upload static docs as artifact
        id: upload
        uses: actions/upload-pages-artifact@v3
        with:
          path: swagger-html

  deploy:
    needs: build
    runs-on: ubuntu-latest
    permissions:
      pages: write
      id-token: write
    environment:
      name: github-pages
      url: ${{ steps.upload.outputs.page_url }}
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
